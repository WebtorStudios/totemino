<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script>
        (function() {
            const saved = localStorage.getItem('totemino_theme');
            const theme = saved || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
            
            window.addEventListener('pageshow', function(event) {
                if (event.persisted || performance.getEntriesByType('navigation')[0]?.type === 'back_forward') {
                location.reload();
                }
            });
        })();
	</script>	
    <title>Accesso Negato - Totemino</title>
    <link rel="icon" type="image/png" href="img/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="index-styles.css">
    <style>
        .pricing {
            background: none!important;
        }

        /* Animazione loading dots per bottoni pricing */
        .btn-pricing.loading {
            pointer-events: none;
        }

        .btn-pricing .btn-text {
            display: inline;
            font-weight: 600;
        }

        .btn-pricing.loading .btn-text {   
            display: none;
        }

        .loading-dots {
            display: none;
            gap: 8px;
        }

        .btn-pricing.loading .loading-dots {
            display: flex;
            margin: 5px auto;
            align-items: center;
            justify-content: center;
        }

        .loading-dots span {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background-color: currentColor;
            animation: loadingDot 1.4s infinite ease-in-out both;
        }

        .loading-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .loading-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes loadingDot {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }
    </style>
</head>
<body>

	<div class="bg-light light1"></div>
	<div class="bg-light light2"></div>
	<div class="bg-light light3"></div>
	
	<!-- Header -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img class="theme-img" data-light="img/logo/1_light.png" data-dark="img/logo/1_dark.png" alt="Totemino Logo" id="logoSwap">
                <a href="index.html"><h1>Totemino</h1></a>
            </div>
            <div class="nav-actions">
                <button id="theme" class="nav-btn theme-btn" type="button">
                    <img class="theme-img" data-light="img/theme_light.png" data-dark="img/theme_dark.png" alt="Tema">
                </button>
                <a href="login.html" class="nav-btn login-btn">Profilo</a>
            </div>
        </div>
    </nav>

    <!-- Comparison Table -->
    <section class="comparison-section" style="margin-top: 8rem;">
        <div class="section-header">
            <h2>Confronta i Piani</h2>
            <p>Scegli il piano perfetto per il tuo ristorante</p>
        </div>
        
        <div class="comparison-wrapper">
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Funzionalità</th>
                        <th class="th-hobby">Hobby</th>
                        <th class="th-premium">Premium</th>
                        <th class="th-pro">Pro</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="feature-name">Menù digitale a solo visualizzazione</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">QR code personalizzati</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Gestione menù facile</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Aggiunta di prodotti illimitati</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Ingredienti e allergeni</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Supporto 24/7</td>
                        <td class="td-hobby"><i class="fas fa-check"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Ordinazioni dall'app</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Gestione comande LIVE</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Menù con Servizio al tavolo e Take away</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Prenotazione tavoli</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Banner promozionali</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Codici sconto e promozioni</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Boost alle recensioni</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-check"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Configurazione orari e costi consegna</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Report e statistiche dettagliate mensili</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Suggerimenti con IA al checkout (+20% ATV)</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Domicilio con 0% commissioni</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Setup del menù iniziale</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                    <tr>
                        <td class="feature-name">Temi e colori personalizzati</td>
                        <td class="td-hobby"><i class="fas fa-times"></i></td>
                        <td class="td-premium"><i class="fas fa-times"></i></td>
                        <td class="td-pro"><i class="fas fa-check"></i></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    
    <!-- Pricing Section -->
    <section class="pricing">
        <div class="section-header">
            <h2>Migliora il tuo Ristorante</h2>
            <p>Per aumentare le tue vendite e la tua presenza online, fai l'upgrade al piano</p>
        </div>
        <div class="pricing-grid">
            <!-- Hobby Plan -->
            <div class="pricing-card" id="p-hobby">
                <div class="pricing-header">
                    <h3>Hobby</h3>
                    <p>Alle prime armi con strumenti digitali</p>
                    <div class="price">
                        <span class="currency">€</span>
                        <span class="amount">29</span>
                        <span class="period">/mese + IVA</span>
                    </div>
                </div>
                <a class="btn-pricing" data-price-id="price_1Sc7bC7dAnRE04Pk4s9xD4El">
                    <span class="btn-text">Passa a Hobby</span>
                    <span class="loading-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </a>
                <ul class="features-list">
                    <li><img src="img/check.png"> Menu solo visualizzazione</li>
                    <li><img src="img/check.png"> Gestione menu semplice</li>
                    <li><img src="img/check.png"> Aggiunta di prodotti illimitati</li>
                    <li><img src="img/check.png"> QR code personalizzati</li>
                    <li><img src="img/check.png"> Aggiornamenti futuri</li>
                </ul>
            </div>

            <!-- Premium Plan -->
            <div class="pricing-card" id="p-premium">
                <div class="pricing-header">
                    <h3>Premium</h3>
                    <p>Per gestione smart di ordini & comande</p>
                    <div class="price">
                        <span class="currency">€</span>
                        <span class="amount">69</span>
                        <span class="period">/mese + IVA</span>
                    </div>
                </div>
                <a class="btn-pricing" data-price-id="price_1Sc7eA7dAnRE04PkniueG6en">
                    <span class="btn-text">Passa a Premium</span>
                    <span class="loading-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </a>
                <ul class="features-list">
                    <li><img src="img/check.png"> Tutte le funzioni Hobby</li>
                    <li><img src="img/check.png"> Ordinazioni base dall'app</li>
                    <li><img src="img/check.png"> Gestione delle comande LIVE</li>
                    <li><img src="img/check.png"> Banner promozionali nel menu</li>
                    <li><img src="img/check.png"> Supporto e formazione</li>
                </ul>
            </div>
			
            <!-- Pro Plan -->
            <div class="pricing-card featured" id="p-pro">
                <div class="popular-badge">Consigliato</div>
                <div class="pricing-header">
                    <h3>Pro</h3>
                    <p>Per automazione e controllo</p>
                    <div class="price">
                        <span class="currency">€</span>
                        <span class="amount">149</span>
                        <span class="period">/mese + IVA</span>
                    </div>
                </div>
                <a class="btn-pricing" data-price-id="price_1Sc7ex7dAnRE04PkjcQ3RALK">
                    <span class="btn-text">Diventa Pro</span>
                    <span class="loading-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </a>
                <ul class="features-list">
                    <li><img src="img/check.png"> Tutte le funzioni di Premium</li>
                    <li><img src="img/check.png"> Domicilio con 0% di commissioni</li>
                    <li><img src="img/check.png"> Suggerimenti con IA al checkout</li>
                    <li><img src="img/check.png"> Statistiche e report mensili</li>
                    <li><img src="img/check.png"> Menu iniziale configurato da noi</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-container">
            
            <div class="footer-content">
            <div class="footer-left">
                <p class="footer-brand">Totemino</p>
                <p class="footer-tagline">Il tuo compagno di ristorazione</p>
                <p class="footer-contact">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                </svg>
                351 054 8462
                </p>
            </div>

            <nav class="footer-nav">
                <h4 class="footer-nav-title">Cosa offriamo</h4>
                <a href="servizi.html">Servizi</a>
                <a href="upgrade.html">Piani</a>
                <a href="about.html">Chi siamo</a>
                <a href="#">Contattaci</a>
            </nav>

            <div class="footer-social-section">
                <h4 class="footer-nav-title">Seguici</h4>
                <div class="footer-social">
                <a href="https://wa.me/+393510548462" aria-label="WhatsApp">
                    <img src="img/whatsapp-logo.png" alt="WhatsApp">
                </a>
                <a href="https://instagram.com/webtorstudios" aria-label="Instagram">
                    <img src="img/instagram-logo.png" alt="Instagram">
                </a>
                <a href="mailto:webtorstudios@gmail.com" aria-label="Email">
                    <img src="img/mail-logo.png" alt="Email">
                </a>
                </div>
            </div>
            </div>

        </div>

        <div class="footer-bottom">
            <p>© 2026 Totemino. Tutti i diritti riservati.</p>
            <div class="footer-links">
            <a href="termini-e-condizioni.html">Termini e condizioni</a>
            <span class="separator">•</span>
            <a href="cookie-policy.html">Informativa Privacy</a>
            </div>
        </div>
    </footer>
	
 	<script src="index-script.js"></script>
    <script>
        // Recupera il piano attuale dal server e nasconde quello corrente + inferiori
        document.addEventListener("DOMContentLoaded", async function() {
			const hobbyCard = document.querySelector('#p-hobby');
			const premiumCard = document.querySelector('#p-premium');
			const proCard = document.querySelector('#p-pro');

			try {
				// Chiama l'endpoint /api/auth/me per ottenere il piano corrente
				const response = await fetch('/api/auth/me', {
					credentials: 'include'
				});
				
				const data = await response.json();
				
				if (data.success && data.user && data.user.planType) {
					const currentPlan = data.user.planType;
					
					// Gerarchia: hobby < premium < pro
					if (currentPlan === 'hobby') {
						// Nascondi hobby
						if (hobbyCard) hobbyCard.style.display = 'none';
					} else if (currentPlan === 'premium') {
						// Nascondi hobby e premium
						if (hobbyCard) hobbyCard.style.display = 'none';
						if (premiumCard) premiumCard.style.display = 'none';
					} else if (currentPlan === 'pro') {
						// Utente già al piano massimo, reindirizza a profile.html
						window.location.href = 'profile.html';
						return;
					}
				}
			} catch (error) {
				console.error('Errore nel recupero del piano corrente:', error);
				// In caso di errore, mostra tutti i piani
			}
        });
    </script>
    <script>
        document.querySelectorAll('.btn-pricing').forEach(btn => {
            btn.addEventListener('click', async (e) => {
                e.preventDefault();
                
                // Aggiungi classe loading
                btn.classList.add('loading');
                
                const priceId = btn.dataset.priceId;
                
                try {
                    const response = await fetch('/api/create-checkout', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        credentials: 'include',
                        body: JSON.stringify({ priceId })
                    });
                    
                    const data = await response.json();
                    
                    if (data.url) {
                        window.location.href = data.url;
                    } else {
                        // Rimuovi loading in caso di errore
                        btn.classList.remove('loading');
                        alert('Errore: ' + (data.error || 'Impossibile creare la sessione'));
                    }
                } catch (error) {
                    // Rimuovi loading in caso di errore
                    btn.classList.remove('loading');
                    console.error('Errore:', error);
                    alert('Errore di connessione. Riprova.');
                }
            });
        });
    </script>
	<script src="theme.js"></script>
 	<script src="logo-pop.js"></script>
</body>

</html>

